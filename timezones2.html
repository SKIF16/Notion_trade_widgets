<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Forex Market Sessions Widget</title>
<style>
  body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    background: #f5f5f5;
  }
  .widget {
    max-width: 420px;
    margin: auto;
    padding: 20px;
    background: #ffffff;
    border-radius: 14px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.12);
  }
  h2 {
    text-align: center;
    margin-bottom: 15px;
  }
  .session {
    margin: 12px 0;
  }
  .label {
    display: flex;
    justify-content: space-between;
    margin-bottom: 5px;
    font-weight: bold;
  }
  .bar {
    width: 100%;
    height: 10px;
    background: #ddd;
    border-radius: 6px;
    position: relative;
  }
  .fill {
    height: 100%;
    background: #4CAF50;
    border-radius: 6px;
    position: absolute;
    top: 0;
    left: 0;
  }
</style>
</head>
<body>
<div class="widget">
  <h2>Forex Market Sessions</h2>

  <div id="sessions"></div>
</div>

<script>
// Market sessions with UTC times
const sessions = [
  { name: "Sydney", open: 22, close: 7 },
  { name: "Tokyo", open: 23, close: 8 },
  { name: "Frankfurt", open: 7, close: 16 },
  { name: "London", open: 8, close: 17 },
  { name: "New York", open: 13, close: 22 }
];

function createSessionHTML(name, progress, nowLocal) {
  return `
    <div class="session">
      <div class="label">
        <span>${name}</span>
        <span>${nowLocal}</span>
      </div>
      <div class="bar">
        <div class="fill" style="width:${progress}%;"></div>
      </div>
    </div>`;
}

function updateWidget() {
  const container = document.getElementById("sessions");
  container.innerHTML = "";

  const now = new Date();
  const utcHour = now.getUTCHours();
  const localTime = now.toLocaleTimeString([], {hour: "2-digit", minute: "2-digit"});

  sessions.forEach(s => {
    let progress = 0;

    if (s.open < s.close) {
      if (utcHour >= s.open && utcHour <= s.close) {
        progress = ((utcHour - s.open) / (s.close - s.open)) * 100;
      }
    } else {
      // Overnight session (Sydney)
      if (utcHour >= s.open || utcHour <= s.close) {
        progress = (utcHour >= s.open ? utcHour - s.open : utcHour + (24 - s.open)) / (24 - s.open + s.close) * 100;
      }
    }

    container.innerHTML += createSessionHTML(s.name, progress, localTime);
  });
}

updateWidget();
setInterval(updateWidget, 60000);
</script>
</body>
</html>
